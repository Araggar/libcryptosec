<head>
	<title>libcryptosec Documentation</title>
	<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <link href="doxygen.css" rel="stylesheet" type="text/css">
    <link href="tabs.css" rel="stylesheet" type="text/css">
</head>
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_72b75b0292261683030c07169f96c30c.html">libcryptosec</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Pkcs7SignedData.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Pkcs7SignedData_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef PKCS7SIGNEDDATA_H_</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define PKCS7SIGNEDDATA_H_</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MessageDigest_8h.html">MessageDigest.h</a>&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="CertPathValidatorResult_8h.html">libcryptosec/certificate/CertPathValidatorResult.h</a>&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="CertPathValidator_8h.html">libcryptosec/certificate/CertPathValidator.h</a>&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ValidationFlags_8h.html">libcryptosec/certificate/ValidationFlags.h</a>&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="CertificateRevocationList_8h.html">libcryptosec/certificate/CertificateRevocationList.h</a>&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pkcs7_8h.html">Pkcs7.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Pkcs7Exception_8h.html">libcryptosec/exception/Pkcs7Exception.h</a>&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="classPkcs7SignedData.html">   18</a></span>&#160;<span class="keyword">class </span><a class="code" href="classPkcs7SignedData.html">Pkcs7SignedData</a> : <span class="keyword">public</span> <a class="code" href="classPkcs7.html">Pkcs7</a></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;{</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    </div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structPkcs7SignedData_1_1VERIFY__ERROR.html">   23</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structPkcs7SignedData_1_1VERIFY__ERROR.html">VERIFY_ERROR</a></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        </div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    };</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="classPkcs7SignedData.html#a888bde7f3e1e41d937f2d06069cf07a0">Pkcs7SignedData</a>(PKCS7 *<a class="code" href="classPkcs7.html#a6203e8d39244bd0f8d411373201facc9">pkcs7</a>) <span class="keywordflow">throw</span> (<a class="code" href="classPkcs7Exception.html">Pkcs7Exception</a>);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    </div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classPkcs7SignedData.html#a6ab282853534c45e5dfd3fee4e9a51d2">~Pkcs7SignedData</a>();</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keyword">virtual</span> <a class="code" href="classPkcs7.html#a099db73af7d5271259a8c8eb70ac04dd">Pkcs7::Type</a> <a class="code" href="classPkcs7SignedData.html#a2f710c5085ad93f39336cfbc072d09b4">getType</a>();</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    std::vector&lt;Certificate *&gt; <a class="code" href="classPkcs7SignedData.html#a116d8094cb1ad97304c339d2d50b3d54">getCertificates</a>();</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    </div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    </div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    std::vector&lt;CertificateRevocationList *&gt; <a class="code" href="classPkcs7SignedData.html#a4df03a7fadff61d9975aa209d80e5906">getCrls</a>();</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">//bool verify();</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    </div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    </div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">     * Verifica a assinatura e/ou a integridade do pacote PKCS7</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">     * @return true se o pacote é íntegro e/ou suas assinaturas são válidas</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">     * @param checkSignerCert true para verificar as assinaturas do pacote, false caso contrário</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">     * @param trusted certificados confiáveis</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">     * @param cpvr objeto resultado da verificação das assinaturas</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">     * @flags opções de validação (ver CertPathValidator::ValidationFlags)</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPkcs7SignedData.html#aabfe12f7d95b5fd01d59f7d2ce5e03e6">verify</a>(<span class="keywordtype">bool</span> checkSignerCert = <span class="keyword">false</span>, vector&lt;Certificate&gt; trusted = vector&lt;Certificate&gt;(), <a class="code" href="classCertPathValidatorResult.html">CertPathValidatorResult</a> **<a class="code" href="classPkcs7SignedData.html#a1f882f89f1c0e5dfc36c41add32eccab">cpvr</a> = NULL, vector&lt;ValidationFlags&gt;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        flags = vector&lt;ValidationFlags&gt;());</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    </div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">     * Função callback de tratamento de erro de validação de assinaturas</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">     * @param ok resultado da verificação</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">     * @param ctx contexto de certificado</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">     * @return 1</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classPkcs7SignedData.html#ae1c51cfc8f1d8664c5ef20738835b2e3">callback</a>(<span class="keywordtype">int</span> ok, X509_STORE_CTX *ctx);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    </div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    </div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPkcs7SignedData.html#ae7b05edaac0f302bd731b1e7855a2034">verifyAndExtract</a>(std::ostream *out) <span class="keywordflow">throw</span> (<a class="code" href="classPkcs7Exception.html">Pkcs7Exception</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    </div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classPkcs7SignedData.html#a1f882f89f1c0e5dfc36c41add32eccab">   97</a></span>&#160;    <span class="keyword">static</span> <a class="code" href="classCertPathValidatorResult.html">CertPathValidatorResult</a> <a class="code" href="classPkcs7SignedData.html#a1f882f89f1c0e5dfc36c41add32eccab">cpvr</a>; </div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;};</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//nao utilizado</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//static void nodes_print(BIO *out, const char *name, STACK_OF(X509_POLICY_NODE) *nodes);</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//static void policies_print(BIO *out, X509_STORE_CTX *ctx);</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/*PKCS7SIGNEDDATA_H_*/</span><span class="preprocessor"></span></div><div class="ttc" id="classCertPathValidatorResult_html"><div class="ttname"><a href="classCertPathValidatorResult.html">CertPathValidatorResult</a></div><div class="ttdef"><b>Definition:</b> CertPathValidatorResult.h:22</div></div>
<div class="ttc" id="CertPathValidatorResult_8h_html"><div class="ttname"><a href="CertPathValidatorResult_8h.html">CertPathValidatorResult.h</a></div></div>
<div class="ttc" id="classPkcs7SignedData_html_a4df03a7fadff61d9975aa209d80e5906"><div class="ttname"><a href="classPkcs7SignedData.html#a4df03a7fadff61d9975aa209d80e5906">Pkcs7SignedData::getCrls</a></div><div class="ttdeci">std::vector&lt; CertificateRevocationList * &gt; getCrls()</div><div class="ttdoc">Retorna uma lista com as crls inclusas nesse pacote. </div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.cpp:38</div></div>
<div class="ttc" id="classPkcs7_html"><div class="ttname"><a href="classPkcs7.html">Pkcs7</a></div><div class="ttdoc">Classe abstrata que implementa a especificação PKCS#7 para empacotamento de conteúdo utilizando cript...</div><div class="ttdef"><b>Definition:</b> Pkcs7.h:31</div></div>
<div class="ttc" id="classPkcs7_html_a6203e8d39244bd0f8d411373201facc9"><div class="ttname"><a href="classPkcs7.html#a6203e8d39244bd0f8d411373201facc9">Pkcs7::pkcs7</a></div><div class="ttdeci">PKCS7 * pkcs7</div><div class="ttdoc">Ponteiro para a estrutura PKCS7 da biblioteca OpenSSL. </div><div class="ttdef"><b>Definition:</b> Pkcs7.h:93</div></div>
<div class="ttc" id="CertificateRevocationList_8h_html"><div class="ttname"><a href="CertificateRevocationList_8h.html">CertificateRevocationList.h</a></div></div>
<div class="ttc" id="classPkcs7SignedData_html_a1f882f89f1c0e5dfc36c41add32eccab"><div class="ttname"><a href="classPkcs7SignedData.html#a1f882f89f1c0e5dfc36c41add32eccab">Pkcs7SignedData::cpvr</a></div><div class="ttdeci">static CertPathValidatorResult cpvr</div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.h:97</div></div>
<div class="ttc" id="classPkcs7SignedData_html"><div class="ttname"><a href="classPkcs7SignedData.html">Pkcs7SignedData</a></div><div class="ttdoc">Representa um pacote PKCS7 assinado. </div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.h:18</div></div>
<div class="ttc" id="classPkcs7SignedData_html_aabfe12f7d95b5fd01d59f7d2ce5e03e6"><div class="ttname"><a href="classPkcs7SignedData.html#aabfe12f7d95b5fd01d59f7d2ce5e03e6">Pkcs7SignedData::verify</a></div><div class="ttdeci">bool verify(bool checkSignerCert=false, vector&lt; Certificate &gt; trusted=vector&lt; Certificate &gt;(), CertPathValidatorResult **cpvr=NULL, vector&lt; ValidationFlags &gt; flags=vector&lt; ValidationFlags &gt;())</div><div class="ttdoc">Verifica a integridade do pacote PKCS7. </div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.cpp:74</div></div>
<div class="ttc" id="Pkcs7_8h_html"><div class="ttname"><a href="Pkcs7_8h.html">Pkcs7.h</a></div></div>
<div class="ttc" id="classPkcs7SignedData_html_ae7b05edaac0f302bd731b1e7855a2034"><div class="ttname"><a href="classPkcs7SignedData.html#ae7b05edaac0f302bd731b1e7855a2034">Pkcs7SignedData::verifyAndExtract</a></div><div class="ttdeci">bool verifyAndExtract(std::ostream *out)</div><div class="ttdoc">Verifica a integridade do pacote PKCS7 e extrai seu conteúdo para o stream de saída passado como parâ...</div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.cpp:175</div></div>
<div class="ttc" id="structPkcs7SignedData_1_1VERIFY__ERROR_html"><div class="ttname"><a href="structPkcs7SignedData_1_1VERIFY__ERROR.html">Pkcs7SignedData::VERIFY_ERROR</a></div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.h:23</div></div>
<div class="ttc" id="MessageDigest_8h_html"><div class="ttname"><a href="MessageDigest_8h.html">MessageDigest.h</a></div></div>
<div class="ttc" id="classPkcs7SignedData_html_a2f710c5085ad93f39336cfbc072d09b4"><div class="ttname"><a href="classPkcs7SignedData.html#a2f710c5085ad93f39336cfbc072d09b4">Pkcs7SignedData::getType</a></div><div class="ttdeci">virtual Pkcs7::Type getType()</div><div class="ttdoc">Implementa o método abstrato Pkcs7::getType(). </div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.cpp:17</div></div>
<div class="ttc" id="classPkcs7SignedData_html_ae1c51cfc8f1d8664c5ef20738835b2e3"><div class="ttname"><a href="classPkcs7SignedData.html#ae1c51cfc8f1d8664c5ef20738835b2e3">Pkcs7SignedData::callback</a></div><div class="ttdeci">static int callback(int ok, X509_STORE_CTX *ctx)</div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.cpp:203</div></div>
<div class="ttc" id="ValidationFlags_8h_html"><div class="ttname"><a href="ValidationFlags_8h.html">ValidationFlags.h</a></div></div>
<div class="ttc" id="Pkcs7Exception_8h_html"><div class="ttname"><a href="Pkcs7Exception_8h.html">Pkcs7Exception.h</a></div></div>
<div class="ttc" id="classPkcs7SignedData_html_a888bde7f3e1e41d937f2d06069cf07a0"><div class="ttname"><a href="classPkcs7SignedData.html#a888bde7f3e1e41d937f2d06069cf07a0">Pkcs7SignedData::Pkcs7SignedData</a></div><div class="ttdeci">Pkcs7SignedData(PKCS7 *pkcs7)</div><div class="ttdoc">Construtor padrão recebendo um ponteiro para a estrutura OpenSSL PKCS7. </div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.cpp:5</div></div>
<div class="ttc" id="classPkcs7SignedData_html_a116d8094cb1ad97304c339d2d50b3d54"><div class="ttname"><a href="classPkcs7SignedData.html#a116d8094cb1ad97304c339d2d50b3d54">Pkcs7SignedData::getCertificates</a></div><div class="ttdeci">std::vector&lt; Certificate * &gt; getCertificates()</div><div class="ttdoc">Retorna a lista de certificados que assinaram esse pacote. </div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.cpp:22</div></div>
<div class="ttc" id="classPkcs7Exception_html"><div class="ttname"><a href="classPkcs7Exception.html">Pkcs7Exception</a></div><div class="ttdef"><b>Definition:</b> Pkcs7Exception.h:6</div></div>
<div class="ttc" id="CertPathValidator_8h_html"><div class="ttname"><a href="CertPathValidator_8h.html">CertPathValidator.h</a></div></div>
<div class="ttc" id="classPkcs7_html_a099db73af7d5271259a8c8eb70ac04dd"><div class="ttname"><a href="classPkcs7.html#a099db73af7d5271259a8c8eb70ac04dd">Pkcs7::Type</a></div><div class="ttdeci">Type</div><div class="ttdoc">Determina o tipo de procedimento criptográfico aplicado ao pacote, podendo ser SIGNED caso o conteúdo...</div><div class="ttdef"><b>Definition:</b> Pkcs7.h:43</div></div>
<div class="ttc" id="classPkcs7SignedData_html_a6ab282853534c45e5dfd3fee4e9a51d2"><div class="ttname"><a href="classPkcs7SignedData.html#a6ab282853534c45e5dfd3fee4e9a51d2">Pkcs7SignedData::~Pkcs7SignedData</a></div><div class="ttdeci">virtual ~Pkcs7SignedData()</div><div class="ttdoc">Destrutor padrão, limpa a estrutura PKCS7 aninhada. </div><div class="ttdef"><b>Definition:</b> Pkcs7SignedData.cpp:13</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
